# 深入讲解


# 1.Redis缓存击穿、缓存雪崩、缓存穿透
缓存击穿、缓存雪崩和缓存穿透是我们在日常开发与手撕面试官过程中必须battle的常见问题，下面我会解释它们的含义与解决方案。

## 缓存击穿（Cache Miss） 

### 什么是缓存击穿？
缓存击穿是指在高并发访问下，一个热点数据失效时，大量请求会直接绕过缓存，直接查询数据库，导致数据库压力剧增。
通常情况下，缓存是为了减轻数据库的负载，提高读取性能而设置的。当某个特定的缓存键（key）失效后，在下一次请求该缓存时，由于缓存中没有对应的数据，因此会去数据库中查询，这就是缓存击穿。

### 解决方案：

- 合理的过期时间：设置热点数据永不过期，或者设置较长的过期时间，以免频繁失效。
- 使用互斥锁：保证同一时间只有一个线程来查询数据库，其他线程等待查询结果。

## 缓存雪崩（Cache Avalanche） 

### 什么是缓存雪崩？
缓存雪崩是指在大规模缓存失效或者缓存宕机的情况下，大量请求同时涌入数据库，导致数据库负载过大甚至崩溃的情况。
正常情况下，缓存中的数据会根据过期时间进行更新，当大量数据同时失效时，下一次请求就会直接访问数据库，给数据库带来巨大压力。

### 解决方案：

- 合理的过期时间：为缓存的过期时间引入随机值，分散缓存过期时间，避免大规模同时失效。或者是粗暴的设置热点数据永不过期
- 多级缓存：使用多级缓存架构，如本地缓存 + 分布式缓存，提高系统的容错能力。
- 使用互斥锁：保证同一时间只有一个线程来查询数据库，其他线程等待查询结果。
- 高可用架构：使用Redis主从复制或者集群来增加缓存的可用性，避免单点故障导致整个系统无法使用。

## 缓存穿透（Cache Penetration） 

### 什么是缓存穿透？
缓存穿透是指恶意请求查询一个不存在于缓存和数据库中的数据，导致每次请求都直接访问数据库，从而增加数据库的负载。
攻击者可以通过故意构造不存在的 Key 来进行缓存穿透攻击。

### 解决方案：

- 缓存空对象：对于查询结果为空的情况，也将其缓存起来，但使用较短的过期时间，防止攻击者利用同样的 key 进行频繁攻击。
- 参数校验：在接收到请求之前进行参数校验，判断请求参数是否合法。
- 布隆过滤器：判断请求的参数是否存在于缓存或数据库中。


> 原文: <https://www.yuque.com/tulingzhouyu/db22bv/cz44806n5vqdvf5t>